using System;
using System.Runtime.InteropServices;

namespace Secur32;

[StructLayout(LayoutKind.Sequential)]
public struct SecBufferDesc
{
    public int ulVersion;
    public int cBuffer;
    public nint pBuffers;
}

[StructLayout(LayoutKind.Sequential)]
public struct SecBuffer
{
    public int cbBuffer;
    public int BufferType;
    public nint pvBuffer;
}

[Flags]
public enum AscReq
{
    ASC_REQ_NONE = 0x00000000,
    ASC_REQ_DELEGATE = 0x00000001,
    ASC_REQ_MUTUAL_AUTH = 0x00000002,
    ASC_REQ_REPLAY_DETECT = 0x00000004,
    ASC_REQ_SEQUENCE_DETECT = 0x00000008,
    ASC_REQ_CONFIDENTIALITY = 0x00000010,
    ASC_REQ_USE_SESSION_KEY = 0x00000020,
    ASC_REQ_SESSION_TICKET = 0x00000040,
    ASC_REQ_ALLOCATE_MEMORY = 0x00000100,
    ASC_REQ_USE_DCE_STYLE = 0x00000200,
    ASC_REQ_DATAGRAM = 0x00000400,
    ASC_REQ_CONNECTION = 0x00000800,
    ASC_REQ_CALL_LEVEL = 0x00001000,
    ASC_REQ_FRAGMENT_SUPPLIED = 0x00002000,
    ASC_REQ_EXTENDED_ERROR = 0x00008000,
    ASC_REQ_STREAM = 0x00010000,
    ASC_REQ_INTEGRITY = 0x00020000,
    ASC_REQ_LICENSING = 0x00040000,
    ASC_REQ_IDENTIFY = 0x00080000,
    ASC_REQ_ALLOW_NULL_SESSION = 0x00100000,
    ASC_REQ_ALLOW_NON_USER_LOGONS = 0x00200000,
    ASC_REQ_ALLOW_CONTEXT_REPLAY = 0x00400000,
    ASC_REQ_FRAGMENT_TO_FIT = 0x00800000,
    ASC_REQ_NO_TOKEN = 0x01000000,
    ASC_REQ_PROXY_BINDINGS = 0x04000000,
    SSP_REQ_REAUTHENTICATION = 0x08000000,
    ASC_REQ_ALLOW_MISSING_BINDINGS = 0x10000000,
}

[Flags]
public enum AscRet
{
    ASC_RET_DELEGATE = 0x00000001,
    ASC_RET_MUTUAL_AUTH = 0x00000002,
    ASC_RET_REPLAY_DETECT = 0x00000004,
    ASC_RET_SEQUENCE_DETECT = 0x00000008,
    ASC_RET_CONFIDENTIALITY = 0x00000010,
    ASC_RET_USE_SESSION_KEY = 0x00000020,
    ASC_RET_SESSION_TICKET = 0x00000040,
    ASC_RET_ALLOCATED_MEMORY = 0x00000100,
    ASC_RET_USED_DCE_STYLE = 0x00000200,
    ASC_RET_DATAGRAM = 0x00000400,
    ASC_RET_CONNECTION = 0x00000800,
    ASC_RET_CALL_LEVEL = 0x00002000,
    ASC_RET_THIRD_LEG_FAILED = 0x00004000,
    ASC_RET_EXTENDED_ERROR = 0x00008000,
    ASC_RET_STREAM = 0x00010000,
    ASC_RET_INTEGRITY = 0x00020000,
    ASC_RET_LICENSING = 0x00040000,
    ASC_RET_IDENTIFY = 0x00080000,
    ASC_RET_NULL_SESSION = 0x00100000,
    ASC_RET_ALLOW_NON_USER_LOGONS = 0x00200000,
    ASC_RET_ALLOW_CONTEXT_REPLAY = 0x00400000,
    ASC_RET_FRAGMENT_ONLY = 0x00800000,
    ASC_RET_NO_TOKEN = 0x01000000,
    ASC_RET_NO_ADDITIONAL_TOKEN = 0x02000000,
    ASP_RET_REAUTHENTICATION = 0x08000000,
}


[Flags]
public enum CredentialUse
{
    SECPKG_CRED_INBOUND = 0x00000001,
    SECPKG_CRED_OUTBOUND = 0x00000002,
    SECPKG_CRED_BOTH = 0x00000003,
    SECPKG_CRED_DEFAULT = 0x00000004,
    SECPKG_CRED_AUTOLOGON_RESTRICTED = 0x00000010,
    SECPKG_CRED_PROCESS_POLICY_ONLY = 0x00000020,
    SECPKG_CRED_RESERVED = unchecked((int)0xF0000000),
}


[Flags]
public enum IscReq
{
    ISC_REQ_DELEGATE = 0x00000001,
    ISC_REQ_MUTUAL_AUTH = 0x00000002,
    ISC_REQ_REPLAY_DETECT = 0x00000004,
    ISC_REQ_SEQUENCE_DETECT = 0x00000008,
    ISC_REQ_CONFIDENTIALITY = 0x00000010,
    ISC_REQ_USE_SESSION_KEY = 0x00000020,
    ISC_REQ_PROMPT_FOR_CREDS = 0x00000040,
    ISC_REQ_USE_SUPPLIED_CREDS = 0x00000080,
    ISC_REQ_ALLOCATE_MEMORY = 0x00000100,
    ISC_REQ_USE_DCE_STYLE = 0x00000200,
    ISC_REQ_DATAGRAM = 0x00000400,
    ISC_REQ_CONNECTION = 0x00000800,
    ISC_REQ_CALL_LEVEL = 0x00001000,
    ISC_REQ_FRAGMENT_SUPPLIED = 0x00002000,
    ISC_REQ_EXTENDED_ERROR = 0x00004000,
    ISC_REQ_STREAM = 0x00008000,
    ISC_REQ_INTEGRITY = 0x00010000,
    ISC_REQ_IDENTIFY = 0x00020000,
    ISC_REQ_NULL_SESSION = 0x00040000,
    ISC_REQ_MANUAL_CRED_VALIDATION = 0x00080000,
    ISC_REQ_RESERVED1 = 0x00100000,
    ISC_REQ_FRAGMENT_TO_FIT = 0x00200000,
    ISC_REQ_FORWARD_CREDENTIALS = 0x00400000,
    ISC_REQ_NO_INTEGRITY = 0x00800000,
    ISC_REQ_USE_HTTP_STYLE = 0x01000000,
    ISC_REQ_UNVERIFIED_TARGET_NAME = 0x20000000,
    ISC_REQ_CONFIDENTIALITY_ONLY = 0x40000000,
}

[Flags]
public enum IscRet
{
    ISC_RET_DELEGATE = 0x00000001,
    ISC_RET_MUTUAL_AUTH = 0x00000002,
    ISC_RET_REPLAY_DETECT = 0x00000004,
    ISC_RET_SEQUENCE_DETECT = 0x00000008,
    ISC_RET_CONFIDENTIALITY = 0x00000010,
    ISC_RET_USE_SESSION_KEY = 0x00000020,
    ISC_RET_USED_COLLECTED_CREDS = 0x00000040,
    ISC_RET_USED_SUPPLIED_CREDS = 0x00000080,
    ISC_RET_ALLOCATED_MEMORY = 0x00000100,
    ISC_RET_USED_DCE_STYLE = 0x00000200,
    ISC_RET_DATAGRAM = 0x00000400,
    ISC_RET_CONNECTION = 0x00000800,
    ISC_RET_INTERMEDIATE_RETURN = 0x00001000,
    ISC_RET_CALL_LEVEL = 0x00002000,
    ISC_RET_EXTENDED_ERROR = 0x00004000,
    ISC_RET_STREAM = 0x00008000,
    ISC_RET_INTEGRITY = 0x00010000,
    ISC_RET_IDENTIFY = 0x00020000,
    ISC_RET_NULL_SESSION = 0x00040000,
    ISC_RET_MANUAL_CRED_VALIDATION = 0x00080000,
    ISC_RET_RESERVED1 = 0x00100000,
    ISC_RET_FRAGMENT_ONLY = 0x00200000,
    ISC_RET_FORWARD_CREDENTIALS = 0x00400000,
    ISC_RET_USED_HTTP_STYLE = 0x01000000,
    ISC_RET_NO_ADDITIONAL_TOKEN = 0x02000000,
    ISC_RET_REAUTHENTICATION = 0x08000000,
    ISC_RET_CONFIDENTIALITY_ONLY = 0x40000000,
}

public enum SecBufferType
{
    SECBUFFER_EMPTY = 0,
    SECBUFFER_DATA = 1,
    SECBUFFER_TOKEN = 2,
    SECBUFFER_PKG_PARAMS = 3,
    SECBUFFER_MISSING = 4,
    SECBUFFER_EXTRA = 5,
    SECBUFFER_STREAM_TRAILER = 6,
    SECBUFFER_STREAM_HEADER = 7,
    SECBUFFER_NEGOTIATION_INFO = 8,
    SECBUFFER_PADDING = 9,
    SECBUFFER_STREAM = 10,
    SECBUFFER_MECHLIST = 11,
    SECBUFFER_MECHLIST_SIGNATURE = 12,
    SECBUFFER_TARGET = 13,
    SECBUFFER_CHANNEL_BINDINGS = 14,
    SECBUFFER_CHANGE_PASS_RESPONSE = 15,
    SECBUFFER_TARGET_HOST = 16,
    SECBUFFER_ALERT = 17,
    SECBUFFER_APPLICATION_PROTOCOLS = 18,
    SECBUFFER_SRTP_PROTECTION_PROFILES = 19,
    SECBUFFER_SRTP_MASTER_KEY_IDENTIFIER = 20,
    SECBUFFER_TOKEN_BINDING = 21,
    SECBUFFER_PRESHARED_KEY = 22,
    SECBUFFER_PRESHARED_KEY_IDENTITY = 23,
    SECBUFFER_DTLS_MTU = 24,
    SECBUFFER_SEND_GENERIC_TLS_EXTENSION = 25,
    SECBUFFER_SUBSCRIBE_GENERIC_TLS_EXTENSION = 26,
    SECBUFFER_FLAGS = 27,
    SECBUFFER_TRAFFIC_SECRETS = 28,
    SECBUFFER_CERTIFICATE_REQUEST_CONTEXT = 29,
}

[Flags]
public enum SecBufferFlags
{
    SECBUFFER_NONE = 0,
    SECBUFFER_ATTRMASK = unchecked((int)0xF0000000),
    SECBUFFER_READONLY = unchecked((int)0x80000000),
    SECBUFFER_READONLY_WITH_CHECKSUM = unchecked((int)0x10000000),
    SECBUFFER_RESERVED = unchecked((int)0x60000000),
}

public enum TargetDataRep
{
    SECURITY_NATIVE_DREP = 0x00000010,
    SECURITY_NETWORK_DREP = 0x00000000,
}
